

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Avoid security credentials on git public repository &mdash; EMBL-EBI Cloud Portal 0.1.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="EMBL-EBI Cloud Portal 0.1.1 documentation" href="index.html"/>
        <link rel="prev" title="Packaging Applications for the EBI Cloud Portal" href="dev_documentation.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> EMBL-EBI Cloud Portal
          

          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="dev_documentation.html">Packaging Applications for the EBI Cloud Portal</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Avoid security credentials on git public repository</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#git-secrets">git-secrets</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration">Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#advanced-configuration">Advanced configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#before-making-public-a-repository">Before making public a repository</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#setting-a-jenkins-job-guarding-a-repository">Setting a Jenkins job guarding a repository</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">EMBL-EBI Cloud Portal</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Avoid security credentials on git public repository</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/securing_credentials.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="avoid-security-credentials-on-git-public-repository">
<span id="avoid-security-credentials-on-git-public-repository"></span><h1>Avoid security credentials on git public repository<a class="headerlink" href="#avoid-security-credentials-on-git-public-repository" title="Permalink to this headline">¶</a></h1>
<p>AWS accounts, passwords and other sensitive information are a valuable target: outside attackers are continuously scraping GitHub for credentials embedded in the code.Security credential leaks expose sensitive data, resources utilization on your costs, or details of your infrastructure that could lead to sabotage.
It is therefore essential to protect developers from releasing potentially harmful secrets on GitHub.</p>
<p>For our users, we strongly endorse the use of tools for automatic detection.</p>
<div class="section" id="git-secrets">
<span id="git-secrets"></span><h2>git-secrets<a class="headerlink" href="#git-secrets" title="Permalink to this headline">¶</a></h2>
<p>We found a helpful tool, preventing you from adding secrets to your Git repositories: <a class="reference external" href="https://github.com/awslabs/git-secrets">git-secrets</a>, which allows you to create hooks for your local repositories.</p>
<p>The tool causes a commit fails, for every commit containing (detected) security credentials. It requires configuration for each local repository that you want to protect.</p>
<p>It is possible to integrate its use in a CI system, detecting accidental commits, but this strategy will expose your secret.For this reason, we suggest to use it just as second layer protection (in the unfortunate case a developer forget to protect a local repository).</p>
<div class="section" id="installation">
<span id="installation"></span><h3>Installation<a class="headerlink" href="#installation" title="Permalink to this headline">¶</a></h3>
<p>The following steps will download and install the latest version of git-secrets.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">awslabs</span><span class="o">/</span><span class="n">git</span><span class="o">-</span><span class="n">secrets</span>
<span class="n">cd</span> <span class="n">git</span><span class="o">-</span><span class="n">secrets</span>
<span class="n">make</span> <span class="n">install</span>
</pre></div>
</div>
<p>Or, installing with Homebrew (for OS X users).</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">brew</span> <span class="n">install</span> <span class="n">git</span><span class="o">-</span><span class="n">secrets</span>
</pre></div>
</div>
</div>
<div class="section" id="configuration">
<span id="configuration"></span><h3>Configuration<a class="headerlink" href="#configuration" title="Permalink to this headline">¶</a></h3>
<p>It is mandatory to install the git hooks for <strong>every repo</strong> that you wish to use with <code class="docutils literal"><span class="pre">git</span> <span class="pre">secrets</span> <span class="pre">--install</span></code>.</p>
<p>Here’s a quick example of how to ensure a git repository is scanned for secrets on each commit:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">repository</span>
<span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">install</span>
<span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">register</span><span class="o">-</span><span class="n">aws</span>
</pre></div>
</div>
</div>
<div class="section" id="advanced-configuration">
<span id="advanced-configuration"></span><h3>Advanced configuration<a class="headerlink" href="#advanced-configuration" title="Permalink to this headline">¶</a></h3>
<p>First of all, have a look at the official <a class="reference external" href="https://github.com/awslabs/git-secrets">/git-secrets</a> repository.</p>
<p>Add a configuration template if you want to add hooks to all repositories you initialize or clone in the future.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">register</span><span class="o">-</span><span class="n">aws</span> <span class="o">--</span><span class="k">global</span>
</pre></div>
</div>
<p>Add hooks to all your local repositories.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">install</span> <span class="o">~/.</span><span class="n">git</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">git</span><span class="o">-</span><span class="n">secrets</span>
<span class="n">git</span> <span class="n">config</span> <span class="o">--</span><span class="k">global</span> <span class="n">init</span><span class="o">.</span><span class="n">templateDir</span> <span class="o">~/.</span><span class="n">git</span><span class="o">-</span><span class="n">templates</span><span class="o">/</span><span class="n">git</span><span class="o">-</span><span class="n">secrets</span>
</pre></div>
</div>
<p>Add custom providers to scan for security credentials.</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">add</span><span class="o">-</span><span class="n">provider</span> <span class="o">--</span> <span class="n">cat</span> <span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">secret</span><span class="o">/</span><span class="n">file</span><span class="o">/</span><span class="n">patterns</span>
</pre></div>
</div>
</div>
<div class="section" id="before-making-public-a-repository">
<span id="before-making-public-a-repository"></span><h3>Before making public a repository<a class="headerlink" href="#before-making-public-a-repository" title="Permalink to this headline">¶</a></h3>
<p>With <code class="docutils literal"><span class="pre">git-secrets</span></code> is also possible to scan a repository including all revisions:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">secrets</span> <span class="o">--</span><span class="n">scan</span><span class="o">-</span><span class="n">history</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="setting-a-jenkins-job-guarding-a-repository">
<span id="setting-a-jenkins-job-guarding-a-repository"></span><h2>Setting a Jenkins job guarding a repository<a class="headerlink" href="#setting-a-jenkins-job-guarding-a-repository" title="Permalink to this headline">¶</a></h2>
<p>We suggest to set up a second layer protection with a CI task for detect accidental commits.</p>
<ul class="simple">
<li>Define a <code class="docutils literal"><span class="pre">GitHub</span> <span class="pre">project</span></code>-<code class="docutils literal"><span class="pre">Project</span> <span class="pre">url</span></code>, under <code class="docutils literal"><span class="pre">General</span></code> i.e.:</li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>        <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">EMBL</span><span class="o">-</span><span class="n">EBI</span><span class="o">-</span><span class="n">TSI</span><span class="o">/</span><span class="n">cpa</span><span class="o">-</span><span class="n">instance</span><span class="o">/</span>
</pre></div>
</div>
<p><img alt="Jenkins Configuration, Github project checkbox ticked, and URL filled in" src="images/Jenkins_GuardRepoSecret_01.png" /></p>
<ul class="simple">
<li>Specify the same URL under: <code class="docutils literal"><span class="pre">Source</span> <span class="pre">Code</span> <span class="pre">Management</span></code>-<code class="docutils literal"><span class="pre">Git</span></code>-<code class="docutils literal"><span class="pre">Repositories</span></code>-<code class="docutils literal"><span class="pre">Repository</span> <span class="pre">URL</span></code></li>
<li>Flag <code class="docutils literal"><span class="pre">GitHub</span> <span class="pre">hook</span> <span class="pre">trigger</span> <span class="pre">for</span> <span class="pre">GITScm</span> <span class="pre">polling</span></code> under <code class="docutils literal"><span class="pre">Build</span> <span class="pre">Triggers</span></code>.</li>
</ul>
<p><img alt="Jenkins Configuration, Source Code Management, Git selected, and URL filled in, and Build Triggers GitHub hook trigger for GITScm polling ticked" src="images/Jenkins_GuardRepoSecret_02.png" /></p>
<ul class="simple">
<li>Flag <code class="docutils literal"><span class="pre">Delete</span> <span class="pre">workspace</span> <span class="pre">before</span> <span class="pre">build</span> <span class="pre">starts</span></code> under <code class="docutils literal"><span class="pre">Build</span> <span class="pre">Environment</span></code>.</li>
<li>Under <code class="docutils literal"><span class="pre">Build</span></code>-<code class="docutils literal"><span class="pre">Execute</span> <span class="pre">shell</span></code>-<code class="docutils literal"><span class="pre">Command</span></code></li>
</ul>
<div class="highlight-default"><div class="highlight"><pre><span></span>    git secrets --install
    # Add support for AWS secret scan
    git secrets --register-aws
    # Scan the latest git push
    git secrets --scan
    if [ $? -eq 0 ]; then
        echo &quot;git secrets --scan OK&quot;
    else
    echo &quot;git secrets --scan FAIL&quot;
</pre></div>
</div>
<p><img alt="Jenkins Configuration, Build Environment, Delete workspace before build starts checkbox ticked, and Build, Execute shell Command filled in" src="images/Jenkins_GuardRepoSecret_03.png" /></p>
<p>For those with accounts on our jenkins server, this Jenkins job <a class="reference external" href="https://ci.tsi.ebi.ac.uk/job/app-testing/job/secret-check/">https://ci.tsi.ebi.ac.uk/job/app-testing/job/secret-check/</a> has the latest configuration and can be used as a template.</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="dev_documentation.html" class="btn btn-neutral" title="Packaging Applications for the EBI Cloud Portal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, TSI team, EMBL-EBI.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>